# pytestДемо

Этот проект реализует технический выбор автоматизации интерфейса: **Python+Requests+Pytest+YAML+Allure** , в основном для одного из моих интерфейсных проектов, используя Python+Requests для отправки и обработки запроса интерфейса протокола HTTP, используя Pytest в качестве теста executor использует YAML для управления тестовыми данными и Allure для создания тестовых отчетов.
>Связанные проекты интерфейса:：[使用 Python+Flask+MySQL+Redis 开发简单接口实例](https://github.com/wintests/flaskDemo)

## инструкция проекта

В процессе реализации этого проекта весь проект делится на такие модули, как инкапсуляция метода запроса, инкапсуляция интерфейса HTTP, инкапсуляция ключевых слов и тестовые примеры.

Сначала используйте Python для инкапсуляции интерфейса HTTP в интерфейс Python, а затем соберите эти интерфейсы Python в ключевые слова один за другим, а затем соберите ключевые слова в тестовые примеры, а тестовые данные единообразно управляются через файлы YAML, а затем через Pytest выполнение теста запускает эти скрипты и выводит отчеты о тестировании вместе с Allure.

Конечно, если вам интересно, вы также можете выполнить непрерывную интеграцию Jenkins для автоматизации интерфейса.



## Развертывание проекта

Сначала, скачав исходный код проекта, найдите ```requirements.txt``` файл , затем установите зависимость requirements.txt через инструмент pip, и выполните команду:：

```
pip3 install -r requirements.txt
```

Далее модифицируем ```config/setting.ini``` конфигурационный файл.В среде Windows, после установки соответствующих зависимостей, выполняем команду в окне командной строки：

```
pytest
```

**Примечание**：Поскольку здесь я тестирую свой собственный проект интерфейса, если вы хотите напрямую выполнить мой тестовый пример, чтобы увидеть эффект, вам необходимо заранее развернуть проект интерфейса [flaskDemo](https://github.com/wintests/flaskDemo) , упомянутый выше.。

## Структура проекта

- api ====>> Уровень инкапсуляции интерфейса, например инкапсуляция интерфейса HTTP в качестве интерфейса Python
- common ====>> Различные инструменты
- core ====>> requests инкапсуляцию метода запроса, класс возвращаемого ключевого слова
- config ====>> конфигурационный файл
- data ====>>  Управление файлами тестовых данных
- operation ====>> уровень инкапсуляции ключевых слов, например, инкапсуляция нескольких интерфейсов Python в качестве ключевых слов
- pytest.ini ====>> файл конфигурации pytest
- requirements.txt ====>> связанные файлы пакета зависимостей
- testcases ====>> тесткейсы

## Ключевое слово Описание пакета

Ключевые слова должны иметь определенное деловое значение.При инкапсуляции ключевых слов это можно сделать, вызвав несколько интерфейсов. В некоторых случаях, например, при тестировании интерфейса пополнения, после пополнения может потребоваться вызвать интерфейс запроса, чтобы получить последний баланс счета, чтобы определить, соответствует ли результат запроса ожидаемому результату, тогда тест может быть выполнен как следует:

- 1, Во **```充值-查询```** - инкапсулирована в ключевое слово, в котором интерфейсы пополнения и запроса могут вызываться по очереди, а возвращаемый результат ключевого слова может быть настроен。
- 2, Затем, при написании тестового примера, напрямую вызывайте ключевое слово для проверки, тогда вы можете получить результат, возвращаемый ключевым словом, затем при утверждении вы можете напрямую утверждать результат, возвращаемый ключевым словом.。

## Отображение производительности отчета о тестировании

Выполните команду в командной строке：```pytest``` После запуска варианта использования вы получите исходный файл отчета о тестировании, но в это время вы не можете открыть отчет в формате HTML.Также вам необходимо выполнить команду в корневом каталоге проекта для запуска ```allure``` служба：

```
# 需要提前配置allure环境，才可以直接使用命令行
allure serve ./report
```

Наконец, вы можете видеть, что рендеринг отчета о тестировании выглядит следующим образом:


![image.png](https://upload-images.jianshu.io/upload_images/16853007-248f805c82dbf99c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
